<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Instruments - Valuation Modeling Library</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Instruments";
        var mkdocs_page_input_path = "api/instruments.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Valuation Modeling Library
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">API Reference</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../curves/">Curves</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cashflows/">Cashflows</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Instruments</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#bond">Bond</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#cashflows">Cashflows</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#quick-start">Quick start</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#price-with-a-flat-yield">Price with a flat yield</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#price-with-a-yield-curve-discount-factors">Price with a yield curve (discount factors)</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#view-the-cashflow-schedule">View the cashflow schedule</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#pricing">Pricing</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#flat-rate-pricing">Flat-rate pricing</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#curve-based-pricing">Curve-based pricing</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#amortization-table">Amortization table</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#definitions">Definitions</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#per-period-calculations">Per-period calculations</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#duration">Duration</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#expanded-form">Expanded form</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#dv01-parallel-shift">DV01 (parallel shift)</a>
    </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Valuation Modeling Library</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">API Reference</li>
      <li class="breadcrumb-item active">Instruments</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="instruments">Instruments</h1>
<p>This module contains basic fixed-income instruments built on top of the
<code>CashFlowStream</code> and <code>Yield</code> curve utilities.</p>
<p>Currently implemented:</p>
<ul>
<li><code>Bond</code>: level-coupon bond with redemption value, pricing, cashflow schedule,
  amortization table, duration, and DV01.</li>
</ul>
<hr />
<h2 id="bond">Bond</h2>
<p>A <code>Bond</code> is defined by:</p>
<ul>
<li><code>face</code>: coupon face amount (used to compute coupon payments)</li>
<li><code>redemption</code>: principal paid at maturity (e.g., par value)</li>
<li><code>coupon_rate</code>: annual coupon rate in <strong>percent</strong> (e.g. <code>5.0</code> means 5%)</li>
<li><code>maturity</code>: number of periods to maturity</li>
</ul>
<h3 id="cashflows">Cashflows</h3>
<p>The bond pays a level coupon each period and returns redemption at maturity.</p>
<p>Coupon per period:</p>
<div class="arithmatex">\[
C = \frac{\text{face} \cdot \text{coupon_rate}}{100}
\]</div>
<p>Cashflow at time <span class="arithmatex">\( t \)</span>:</p>
<ul>
<li>For <span class="arithmatex">\( t = 1, \dots, n-1 \)</span>: <span class="arithmatex">\( CF_t = C \)</span></li>
<li>For <span class="arithmatex">\( t = n \)</span>: <span class="arithmatex">\( CF_n = C + \text{redemption} \)</span></li>
</ul>
<hr />
<h2 id="quick-start">Quick start</h2>
<h3 id="price-with-a-flat-yield">Price with a flat yield</h3>
<pre><code class="language-python">from fixed_income import Bond

bond = Bond(face=100, redemption=100, coupon_rate=5.0, maturity=10)

price = bond.price(interest=4.0)   # 4% flat yield
print(price)
</code></pre>
<h3 id="price-with-a-yield-curve-discount-factors">Price with a yield curve (discount factors)</h3>
<pre><code class="language-python">from fixed_income import Yield, Bond

curve = Yield(10)
curve.set_flat_rate(1, 10, 4.0)

bond = Bond(face=100, redemption=100, coupon_rate=5.0, maturity=10)
price = bond.price_by_df(curve)

print(price)
</code></pre>
<h3 id="view-the-cashflow-schedule">View the cashflow schedule</h3>
<pre><code class="language-python">df = bond.cashflow()
print(df)
</code></pre>
<p>** TO DO ADD a photo of DataFrame ** </p>
<h2 id="pricing">Pricing</h2>
<h3 id="flat-rate-pricing">Flat-rate pricing</h3>
<p><code>price(interest)</code> discounts the coupons and redemption at a constant rate <span class="arithmatex">\(i\)</span>
(entered as a percent).</p>
<div class="arithmatex">\[
P = C \cdot \frac{1 - (1 + i)^{-n}}{i} + \text{redemption} \cdot (1 + i)^{-n}
\]</div>
<p>where:</p>
<div class="arithmatex">\[
i = \frac{\text{interest}}{100}
\]</div>
<div class="arithmatex">\[
n = \text{maturity}
\]</div>
<div class="arithmatex">\[
C = \text{coupon per period}
\]</div>
<blockquote>
<p><strong>Note:</strong> this assumes <span class="arithmatex">\(i &gt; 0\)</span>.<br />
If you plan to support <span class="arithmatex">\(i = 0\)</span>, that case should be handled separately.</p>
</blockquote>
<hr />
<h3 id="curve-based-pricing">Curve-based pricing</h3>
<p><code>price_by_df(curve)</code> uses spot discount factors from a <code>Yield</code> curve:</p>
<div class="arithmatex">\[
P = \sum_{t=1}^{n-1} C \cdot DF(t) + (C + \text{redemption}) \cdot DF(n)
\]</div>
<p>where:</p>
<div class="arithmatex">\[
DF(t) = \text{Yield.discount_factor}(t)
\]</div>
<hr />
<h2 id="amortization-table">Amortization table</h2>
<p><code>amortiztion(yield_rate, purchase_price=None)</code> produces an effective-interest
amortization schedule (premium/discount amortization).</p>
<h3 id="definitions">Definitions</h3>
<div class="arithmatex">\[
y = \frac{\text{yield_rate}}{100}
\]</div>
<p>Book value at <span class="arithmatex">\(t = 0\)</span>:</p>
<div class="arithmatex">\[
BV_0 =
\begin{cases}
\text{purchase_price}, &amp; \text{if provided} \\
\text{model price}, &amp; \text{otherwise}
\end{cases}
\]</div>
<hr />
<h3 id="per-period-calculations">Per-period calculations</h3>
<p>For each period <span class="arithmatex">\(t = 1, \dots, n\)</span>:</p>
<p><strong>Interest income</strong></p>
<div class="arithmatex">\[
\text{Interest}_t = BV_{t-1} \cdot y
\]</div>
<p><strong>Payment</strong></p>
<div class="arithmatex">\[
\text{Payment}_t =
\begin{cases}
C, &amp; t &lt; n \\
C + \text{redemption}, &amp; t = n
\end{cases}
\]</div>
<p><strong>Amortization</strong></p>
<div class="arithmatex">\[
\text{Amort}_t = \text{Interest}_t - C
\]</div>
<p><strong>Book value update</strong></p>
<div class="arithmatex">\[
BV_t = BV_{t-1} + \text{Amort}_t
\]</div>
<hr />
<p>The returned DataFrame includes the following columns:</p>
<ul>
<li><code>period</code></li>
<li><code>payment</code></li>
<li><code>interest_income</code></li>
<li><code>premium_discount_amort</code></li>
<li><code>book_value</code></li>
</ul>
<hr />
<h2 id="duration">Duration</h2>
<p><code>duration(curve)</code> computes the <strong>Macaulay duration</strong> (in periods) using
curve-based discounting:</p>
<div class="arithmatex">\[
D = \frac{\sum_{t=1}^{n} t \cdot PV(CF_t)}{P}
\]</div>
<p>where:</p>
<div class="arithmatex">\[
P = \text{price_by_df(curve)}
\]</div>
<div class="arithmatex">\[
PV(CF_t) = CF_t \cdot DF(t)
\]</div>
<h3 id="expanded-form">Expanded form</h3>
<div class="arithmatex">\[
D =
\frac{
\sum_{t=1}^{n-1} t \cdot (C \cdot DF(t))
+ n \cdot \big((C + \text{redemption}) \cdot DF(n)\big)
}{
P
}
\]</div>
<hr />
<h2 id="dv01-parallel-shift">DV01 (parallel shift)</h2>
<p><code>dv01(curve, bp=1.0)</code> estimates DV01 using a symmetric difference and a parallel
curve shift.</p>
<ul>
<li><code>bp</code> is in <strong>basis points</strong> (e.g. <code>1.0</code> means 1 bp = 0.01%)</li>
</ul>
<p>Let:</p>
<div class="arithmatex">\[
P_{+} = \text{price under upward shift}
\]</div>
<div class="arithmatex">\[
P_{-} = \text{price under downward shift}
\]</div>
<p>Then:</p>
<div class="arithmatex">\[
DV01 \approx \frac{P_{-} - P_{+}}{2}
\]</div>
<p>This returns the approximate price change for a <strong>1 bp move</strong> (if <code>bp = 1.0</code>).</p>
<hr />
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../cashflows/" class="btn btn-neutral float-left" title="Cashflows"><span class="icon icon-circle-arrow-left"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../cashflows/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
